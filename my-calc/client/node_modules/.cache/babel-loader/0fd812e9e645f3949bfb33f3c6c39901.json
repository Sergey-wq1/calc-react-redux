{"ast":null,"code":"import { makeAutoObservable } from 'mobx';\nimport { evaluate } from 'mathjs';\nimport { forbiddenFirstCharacter, forbiddenLastCharacter, replacementSign } from '../helpers/changesOperationsMath';\nimport saveData from '../api/apiSaveHistory';\nimport historyStore from './historyStore';\n\nconst foundSignIndex = str => {\n  const arr = [];\n\n  for (let i = str.length; i > 0; i -= 1) {\n    if (str[i] === '+' || str[i] === '-' || str[i] === '*' || str[i] === '/') {\n      arr.push(i);\n    }\n  }\n\n  return arr[0];\n};\n\nconst inspectionSigns = _counter => {\n  const indexSign = foundSignIndex(_counter);\n\n  const sliceHistoryStart = _counter.slice(0, indexSign + 1);\n\n  const sliceHistoryEnd = _counter.slice(indexSign + 1, _counter.length);\n\n  if (indexSign) {\n    if (_counter[indexSign - 1] === '(') {\n      const sliceStartPlus = sliceHistoryStart.slice(0, indexSign - 1);\n      const sliceEndPlus = sliceHistoryEnd.slice(0, sliceHistoryEnd.length - 1);\n      return `${sliceStartPlus}${sliceEndPlus}`;\n    }\n\n    return `${sliceHistoryStart}(-${sliceHistoryEnd})`;\n  }\n\n  return _counter;\n};\n\nconst changeSign = _counter => {\n  const sign = ['+', '-', '/', '*'];\n  const lengthCounter = _counter.length;\n\n  if (_counter[lengthCounter - 1] === '-') {\n    const historyCounterPlusEnd = _counter.slice(0, lengthCounter - 1);\n\n    return `${historyCounterPlusEnd}+`;\n  }\n\n  if (_counter[lengthCounter - 1] === '+') {\n    const historyCounter = _counter.slice(0, lengthCounter - 1);\n\n    return `${historyCounter}-`;\n  }\n\n  if (!_counter[lengthCounter - 1].includes(sign)) {\n    return inspectionSigns(_counter);\n  }\n\n  return _counter;\n};\n\nclass NumericStore {\n  constructor() {\n    this.counter = '0';\n\n    this.numericOperation = number => {\n      if (this.counter === '0' && this.counter.length === 1) {\n        this.counter = `${this.counter.slice(1, 2)}${number}`;\n      } else this.counter = `${this.counter}${number}`;\n    };\n\n    this.plusOperation = () => {\n      this.counter = `${replacementSign(this.counter)}+`;\n    };\n\n    this.minusOperation = () => {\n      this.counter = `${replacementSign(this.counter)}-`;\n    };\n\n    this.deleteAllOperation = () => {\n      this.counter = '0';\n    };\n\n    this.multiplyOperation = () => {\n      this.counter = `${replacementSign(this.counter)}*`;\n    };\n\n    this.devideOperation = () => {\n      this.counter = `${replacementSign(this.counter)}/`;\n    };\n\n    this.pointOperation = () => {\n      this.counter = `${replacementSign(this.counter)}.`;\n    };\n\n    this.percentOperation = () => {\n      const indexSign = foundSignIndex(this.counter.slice(0, this.counter.length - 1));\n      const startHistory = this.counter.slice(0, indexSign);\n      const percent = this.counter.slice(indexSign + 1, this.counter.length);\n      const resultBeforePercent = evaluate(startHistory.slice(0, startHistory.length - 1));\n      const resultCounter = evaluate(resultBeforePercent / 100 * percent);\n      this.counter = resultCounter;\n    };\n\n    this.evalOperation = () => {\n      const result = forbiddenFirstCharacter(forbiddenLastCharacter(this.counter));\n      saveData(this.counter, result.toString()).then(() => {\n        historyStore.showNewHistory();\n      });\n      this.counter = result;\n    };\n\n    this.changeSign = () => {\n      this.counter = changeSign(this.counter);\n    };\n\n    makeAutoObservable(this);\n  }\n\n}\n\nexport default new NumericStore();","map":{"version":3,"sources":["D:/github/calc/calc-react-redux/my-calc/client/src/store/numericStore.js"],"names":["makeAutoObservable","evaluate","forbiddenFirstCharacter","forbiddenLastCharacter","replacementSign","saveData","historyStore","foundSignIndex","str","arr","i","length","push","inspectionSigns","_counter","indexSign","sliceHistoryStart","slice","sliceHistoryEnd","sliceStartPlus","sliceEndPlus","changeSign","sign","lengthCounter","historyCounterPlusEnd","historyCounter","includes","NumericStore","constructor","counter","numericOperation","number","plusOperation","minusOperation","deleteAllOperation","multiplyOperation","devideOperation","pointOperation","percentOperation","startHistory","percent","resultBeforePercent","resultCounter","evalOperation","result","toString","then","showNewHistory"],"mappings":"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","sourcesContent":["import { makeAutoObservable } from 'mobx'\r\nimport { evaluate } from 'mathjs'\r\nimport { forbiddenFirstCharacter, forbiddenLastCharacter, replacementSign } from '../helpers/changesOperationsMath'\r\nimport saveData from '../api/apiSaveHistory'\r\nimport historyStore from './historyStore'\r\n\r\nconst foundSignIndex = (str) => {\r\n  const arr = []\r\n  for (let i = str.length; i > 0; i -= 1) {\r\n    if (str[i] === '+' || str[i] === '-'\r\n      || str[i] === '*' || str[i] === '/') {\r\n      arr.push(i)\r\n    }\r\n  }\r\n  return arr[0]\r\n}\r\n\r\nconst inspectionSigns = (_counter) => {\r\n  const indexSign = foundSignIndex(_counter)\r\n  const sliceHistoryStart = _counter.slice(0, indexSign + 1)\r\n  const sliceHistoryEnd = _counter.slice(indexSign + 1, _counter.length)\r\n  if (indexSign) {\r\n    if (_counter[indexSign - 1] === '(') {\r\n      const sliceStartPlus = sliceHistoryStart.slice(0, indexSign - 1)\r\n      const sliceEndPlus = sliceHistoryEnd.slice(0, sliceHistoryEnd.length - 1)\r\n      return `${sliceStartPlus}${sliceEndPlus}`\r\n    }\r\n    return `${sliceHistoryStart}(-${sliceHistoryEnd})`\r\n  }\r\n  return _counter\r\n}\r\n\r\nconst changeSign = (_counter) => {\r\n  const sign = ['+', '-', '/', '*']\r\n  const lengthCounter = _counter.length\r\n  if (_counter[lengthCounter - 1] === '-') {\r\n    const historyCounterPlusEnd = _counter.slice(0, lengthCounter - 1)\r\n    return `${historyCounterPlusEnd}+`\r\n  }\r\n  if (_counter[lengthCounter - 1] === '+') {\r\n    const historyCounter = _counter.slice(0, lengthCounter - 1)\r\n    return `${historyCounter}-`\r\n  } if (!_counter[lengthCounter - 1].includes(sign)) {\r\n    return inspectionSigns(_counter)\r\n  }\r\n  return _counter\r\n}\r\n\r\nclass NumericStore {\r\n  counter = '0'\r\n\r\n  constructor() {\r\n    makeAutoObservable(this)\r\n  }\r\n\r\n  numericOperation = (number) => {\r\n    if (this.counter === '0' && this.counter.length === 1) {\r\n      this.counter = `${this.counter.slice(1, 2)}${number}`\r\n    } else this.counter = `${this.counter}${number}`\r\n  }\r\n\r\n  plusOperation = () => {\r\n    this.counter = `${replacementSign(this.counter)}+`\r\n  }\r\n\r\n  minusOperation = () => {\r\n    this.counter = `${replacementSign(this.counter)}-`\r\n  }\r\n\r\n  deleteAllOperation = () => {\r\n    this.counter = '0'\r\n  }\r\n\r\n  multiplyOperation = () => {\r\n    this.counter = `${replacementSign(this.counter)}*`\r\n  }\r\n\r\n  devideOperation = () => {\r\n    this.counter = `${replacementSign(this.counter)}/`\r\n  }\r\n\r\n  pointOperation = () => {\r\n    this.counter = `${replacementSign(this.counter)}.`\r\n  }\r\n\r\n  percentOperation = () => {\r\n    const indexSign = foundSignIndex(this.counter.slice(0, this.counter.length - 1))\r\n    const startHistory = this.counter.slice(0, indexSign)\r\n    const percent = this.counter.slice(indexSign + 1, this.counter.length)\r\n    const resultBeforePercent = evaluate(startHistory.slice(0, startHistory.length - 1))\r\n    const resultCounter = evaluate((resultBeforePercent / 100) * percent)\r\n    this.counter = resultCounter\r\n  }\r\n\r\n  evalOperation = () => {\r\n    const result = forbiddenFirstCharacter((forbiddenLastCharacter(this.counter)))\r\n    saveData(this.counter, result.toString())\r\n      .then(() => {\r\n        historyStore.showNewHistory()\r\n      })\r\n    this.counter = result\r\n  }\r\n\r\n  changeSign = () => {\r\n    this.counter = changeSign(this.counter)\r\n  }\r\n}\r\n\r\nexport default new NumericStore()"]},"metadata":{},"sourceType":"module"}